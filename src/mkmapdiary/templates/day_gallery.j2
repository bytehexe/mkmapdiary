{% if geo_items or gpx_data %}
## {{ map_title }}

<div id="map_box"></div>
<div id="map-legend" class="map-legend" markdown> [Zoom to fit](#){ id="showall_link" } {% if gpx_file %}· [Download GPX](assets/{{ gpx_file }}){% endif %} |
<span class="text-indigo">▪︎</span> Track ·
<span class="text-green">▪︎</span> Waypoints ·
<span class="text-orange">▪︎</span> Activity areas ·
<span class="text-purple">▪︎</span> Journal entries</div>
<script>
photo_data = {{ geo_items | tojson }};
gpx_data = {{ gpx_data | tojson }};
</script>

{% endif %}
{% if gallery_items %}

## {{ gallery_title }}

<div id="gallery_controls">
{% if has_duplicates %}
<input type="checkbox" id="include_duplicates">
<label for="include_duplicates">Include duplicates</label>
{% endif %}
{% if has_bad_photos %}
<input type="checkbox" id="include_bad_quality">
<label for="include_bad_quality">Include low quality photos</label>
{% endif %}
<input type="checkbox" id="show_quality_icons">
<label for="show_quality_icons">Show quality icons</label>
</div>

<div id="photo_gallery" markdown>
{%- for item in gallery_items -%}
![](assets/{{ item.path.name }}){ height="200" width="200" data-markers="
{%- if item.quality > 0.85 -%}excellent
{%- elif item.quality > 0.7 -%}good
{%- elif item.quality < 0.1 -%}bad
{%- endif -%}
{%- if item.entropy < 6.5 %} low_entropy{% endif -%}
{%- if item.is_duplicate is true %} duplicate{% endif -%}
{%- if item.is_duplicate is false %} canonical{% endif -%}
" }
{%- endfor -%}
</div>
{% endif %}